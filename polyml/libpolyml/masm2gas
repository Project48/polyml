#! /usr/bin/sed -f
s/
//g
s/;#.*//
s/^IFDEF/#ifdef/
s/^ELSE/#else/
s/^ENDIF/#endif/
s/^IFNDEF/#ifndef/
# Convert macro calls.
s/CALLMACRO[ 	]*\([^ 	]*\)[ 	]*\(.*\)/	\1(\2)/
# Convert addresses of the form [eax], [eax+ebx], [eax+ebx*4] into
# (eax), (eax,ebx), (eax,ebx,4)
s/\[\([^]]*\)+\([^]]*\)\*\([^]]*\)]/(\1,\2,\3)/g
s/\[\([^]]*\)+\([^]]*\)]/(\1,\2)/g
s/\[\([^]]*\)]/(\1)/g
